{"componentChunkName":"component---src-templates-blog-template-js","path":"/algorithm-1/","result":{"data":{"cur":{"id":"3d5e85c5-d899-5d43-85c3-8b04e90cb679","html":"<h2 id=\"후위-표기식-만들기\" style=\"position:relative;\"><a href=\"#%ED%9B%84%EC%9C%84-%ED%91%9C%EA%B8%B0%EC%8B%9D-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"후위 표기식 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>후위 표기식 만들기</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\nstack <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n\r\nres <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\r\n\r\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span>\r\n    <span class=\"token keyword\">if</span> x<span class=\"token punctuation\">.</span>isdecimal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n        res <span class=\"token operator\">+=</span> x\r\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token keyword\">if</span> x<span class=\"token operator\">==</span><span class=\"token string\">'('</span><span class=\"token punctuation\">:</span>\r\n            stack<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">elif</span> x <span class=\"token operator\">==</span> <span class=\"token string\">'*'</span> <span class=\"token keyword\">or</span> x <span class=\"token operator\">==</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">while</span> stack <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span>stack<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'*'</span> <span class=\"token keyword\">or</span> stack<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n                res <span class=\"token operator\">+=</span> stack<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \r\n            stack<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token keyword\">elif</span> x<span class=\"token operator\">==</span><span class=\"token string\">'+'</span> <span class=\"token keyword\">or</span> x<span class=\"token operator\">==</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">while</span> stack <span class=\"token keyword\">and</span> stack<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token string\">'('</span><span class=\"token punctuation\">:</span>\r\n                res <span class=\"token operator\">+=</span> stack<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n            \r\n            stack<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">elif</span> x <span class=\"token operator\">==</span><span class=\"token string\">')'</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">while</span> stack <span class=\"token keyword\">and</span> stack<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span> <span class=\"token string\">'('</span><span class=\"token punctuation\">:</span>\r\n                res <span class=\"token operator\">+=</span> stack<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n            stack<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n\r\n<span class=\"token keyword\">while</span> stack<span class=\"token punctuation\">:</span>\r\n    res <span class=\"token operator\">+=</span> stack<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span></code></pre></div>\n<p>후위 표기식은 stack을 이용해 만들 수 있다.</p>\n<p>우선 순위라는 키워드에 주목한다면 어떻게 해야하는 지 금방 감이 잡힌다.</p>\n<p>만일 10진수 숫자라면 그대로 <code>res</code>에 추가해 준다.</p>\n<p>이제 우선 순위대로 만일 <code>(</code>표기를 만난다면 그대로 스택에 넣어준다.</p>\n<p>이후, <code>*</code>나 <code>/</code>를 스택에다 넣으려고 할 때, 이 연산자들보다 우선 순위가 같거나 높은 것이 스택 안에 없다면 그대로 넣어 두면 되지만, 만약 높거나 같은 것이 있다면 스택에서 빼내어 연산처리를 해주어야 한다.</p>\n<p>즉, 먼저 연산 해주고, 그 다음 들어가는 연산자들에 대해 나중에 처리한다는 것이다.</p>\n<p><code>(</code>와 <code>)</code>도 마찬가지로 해주면 된다.</p>\n<br />\n<h2 id=\"수-찾기백준-1920\" style=\"position:relative;\"><a href=\"#%EC%88%98-%EC%B0%BE%EA%B8%B0%EB%B0%B1%EC%A4%80-1920\" aria-label=\"수 찾기백준 1920 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>수 찾기(백준 1920)</h2>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">compare</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span><span class=\"token operator\">*</span> arg1<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span><span class=\"token operator\">*</span> arg2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">int</span> a <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>arg1<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> b <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>arg2<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">></span> b<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">&lt;</span> b<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    \r\n    <span class=\"token keyword\">int</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> start<span class=\"token punctuation\">,</span> end<span class=\"token punctuation\">,</span> mid<span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">;</span>\r\n\r\n    \r\n    <span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span><span class=\"token operator\">*</span> arr_a <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>a<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>arr_a<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span><span class=\"token operator\">*</span> arr_b <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>b<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>arr_b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">qsort</span><span class=\"token punctuation\">(</span>arr_a<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> compare<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>b<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        start<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span> a<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> flag<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>start <span class=\"token operator\">&lt;=</span> end<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">+</span> end<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\r\n\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>arr_b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> arr_a<span class=\"token punctuation\">[</span>mid<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                flag <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>arr_b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> arr_a<span class=\"token punctuation\">[</span>mid<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                end <span class=\"token operator\">=</span> mid <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>arr_b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> arr_a<span class=\"token punctuation\">[</span>mid<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                start <span class=\"token operator\">=</span> mid <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">else</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>arr_a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>arr_b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>해당 문제는 퀵소트를 통해 정렬한 후, 이분 탐색을 통해 시간 초과를 막아야 하는 문제이다.</p>\n<p>퀵 소트에 대한 알고리즘은 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>a<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">int</span> temp <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>a<span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span>a <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>b<span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span>b <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">quickSort</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>arr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> start<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> end<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>start <span class=\"token operator\">>=</span> end<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">int</span> key <span class=\"token operator\">=</span> start<span class=\"token punctuation\">,</span> i<span class=\"token operator\">=</span>start<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j<span class=\"token operator\">=</span>end<span class=\"token punctuation\">,</span> temp<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;=</span> j<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;=</span> end <span class=\"token operator\">&amp;&amp;</span> arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> arr<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">></span> start <span class=\"token operator\">&amp;&amp;</span> arr<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> arr<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">></span> j<span class=\"token punctuation\">)</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>arr<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>arr<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">else</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>arr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>arr<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">quickSort</span><span class=\"token punctuation\">(</span>start<span class=\"token punctuation\">,</span> j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">quickSort</span><span class=\"token punctuation\">(</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>특정한 값을 기준으로 큰 숫자와 작은 숫자를 서로 교환한 뒤 배열을 반으로 나눈다는게 기본적인 개념이다.</p>\n<p>배열 값을 교환하는 함수는 swap 함수(인자는 포인터로 메모리 주소를 저장)를 사용했다.</p>\n<p>피벗 값을 정하고, 그 피벗 값보다 작은 값을 오른쪽에서 큰 값을 왼쪽에서 찾는다.</p>\n<p>찾으면서, 작은 값과 큰 값을 교환하는데, 이때 인덱스가 교차한다면, 작은 값/큰 값이 되나 피벗 값이 작은 값보다 작으므로 교환해 준다.</p>\n<p>인덱스가 교차하지 않는다면 그대로 바꾸어준다</p>\n<p>이후, 재귀적으로 퀵소트를 마지막 j를 기준으로 해준다.</p>\n<br />\n<p>c언어에서는 <code>qsort()</code> 라는 함수가 미리 구현되어 있다.</p>\n<p>인자로 <code>해당 배열</code>, <code>사이즈</code>, <code>sizeof(int)</code>, <code>compare함수</code>가 들어간다.</p>\n<p>여기서 compare함수는 퀵소트를 위한 비교함수로 int형 포인터로 형변환 시킨 후, 이 값을 역 참조하여 int 값을 저장시킨다.</p>\n<p>이후, a와 b의 값을 비교하여 a가 크다면 1을 리턴, 작다면 -1을 리턴, 같다면 0을 리턴하여 오름차순으로 정렬하도록 한다.</p>\n<br />\n<p>이제 이분 탐색을 통해 배열 각각의 값을 찾고, 만약 찾아낸다면 flag에 1을 저장하여 출력한다. 아니라면 0을 출력한다.</p>","excerpt":"후위 표기식 만들기 후위 표기식은 stack을 이용해 만들 수 있다. 우선 순위라는 키워드에 주목한다면 어떻게 해야하는 지 금방 감이 잡힌다. 만일 10진수 숫자라면 그대로 res에 추가해 준다. 이제 우선 순위대로 만일 (표기를 만난다면 그대로 스택에 넣어준다. 이후, *나 /를 스택에다 넣으려고 할 때, 이 연산자들보다 우선 순위가 같거나 높은 것이 스택 안에 없다면 그대로 넣어 두면 되지만, 만약 높거나 같은 것이 있다면 스택에서 빼내어 연산처리를 해주어야 한다. 즉, 먼저 연산 해주고, 그 다음 들어가는 연산자들에 대해 나중에 처리한다는 것이다. (와 )도 마찬가지로 해주면 된다. 수 찾기(백준 1920) 해당 문제는 퀵소트를 통해 정렬한 후, 이분 탐색을 통해 시간 초과를 막아야 하는 문제이다. 퀵 소트에 대한 알고리즘은 다음과 같다. 특정한 값을 기준으로 큰 숫자와 작은 숫자를 서로 교환한 뒤 배열을 반으로 나눈다는게 기본적인 개념이다. 배열 값을 교환하는 함수는 swa…","frontmatter":{"date":"March 23, 2023","title":"TIL 코테 - 3월","categories":"Engineer","author":"DEVEL","emoji":"🐰"},"fields":{"slug":"/algorithm-1/"}},"next":{"id":"c71785d7-0243-5609-ae4b-5b904776f420","html":"<h2 id=\"제-5장-빅데이터의-파이프라인\" style=\"position:relative;\"><a href=\"#%EC%A0%9C-5%EC%9E%A5-%EB%B9%85%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8\" aria-label=\"제 5장 빅데이터의 파이프라인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>제 5장. 빅데이터의 파이프라인</h2>\n<p>이 장에서는 빅데이터 파이프라인을 자동화하기 위한 구조에 대해 살펴봅니다.</p>\n<br />\n<br />\n<h3 id=\"워크플로-관리\" style=\"position:relative;\"><a href=\"#%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C-%EA%B4%80%EB%A6%AC\" aria-label=\"워크플로 관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>워크플로 관리</h3>\n<br />\n<ul>\n<li><strong>워크플로 관리</strong></li>\n</ul>\n<br />\n<p>정해진 업무를 원할하게 진행하기 위한 구조입니다.</p>\n<br />\n<p>워크플로 관리도구의 주요 역할은 정기적으로 태스크를 실행하고 비정상적인 상태를 감지하여 그것에 대한 해결을 돕는 것입니다</p>\n<br />\n<p>오픈 소스 워크플로 관리 도구 예</p>\n<br />\n<ul>\n<li>Airflow : <code>스크립트 형</code></li>\n<li>Azkaban : <code>선언 형</code></li>\n<li>Digdag : <code>선언 형</code></li>\n<li>Luigi : : <code>스크립트 형</code></li>\n<li>Oozie : <code>선언 형</code></li>\n</ul>\n<br />\n<ul>\n<li><strong>태스크</strong></li>\n</ul>\n<p>데이터 파이프라인의 실행 과정에서 잇달아 이루어지는 개별 처리입니다.</p>\n<br />\n<ul>\n<li><strong>선언 형</strong></li>\n</ul>\n<p>XML이나 YAML 등의 서식으로 워크플로를 기술하는 타입입니다.</p>\n<br />\n<p>미리 제공된 기능만을 사용할 수 있어 단순 반복 생성 워크플로에 최적입니다.</p>\n<br />\n<ul>\n<li><strong>스크립트 형</strong></li>\n</ul>\n<p>스크립트 언어로 워크플로를 정의</p>\n<br />\n<p>스크립트 형 도구는 유연성이 좋습니다. 태스크의 정의를 프로그래밍 할 수 있습니다.</p>\n<br />\n<p>즉 <span style='color:red; font-weight: bold;'>ETL 프로세스에서는 스크립트 형의 도구</span>, 그리고 <span style='color:red; font-weight: bold;'>SQL의 실행에 있어서는 선언형 도구를 보편적으로 사용합니다.</span></p>\n<br />\n<p>일반적으로 데이터 수집과정에서 스크립트 처리가 필요한 경우가 많기 때문입니다.</p>\n<br />\n<hr>\n<br />\n<br />\n<h3 id=\"워크플로의-오류-시-대처방법\" style=\"position:relative;\"><a href=\"#%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9D%98-%EC%98%A4%EB%A5%98-%EC%8B%9C-%EB%8C%80%EC%B2%98%EB%B0%A9%EB%B2%95\" aria-label=\"워크플로의 오류 시 대처방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>워크플로의 오류 시 대처방법</h3>\n<br />\n<p>워크플로 관리에 있어서 <strong>복구</strong>를 전제한 태스크를 설계합니다.</p>\n<br />\n<p>실패한 태스크를 모두 기록해 나중에 재실행할 수 있도록 말이죠.</p>\n<br />\n<p><code>플로우</code>는 워크플로 관리도구에 의해 실행되는 일련의 태스크를 의미합니다.</p>\n<br />\n<p>그리고 각 플로우 실행 시에는 <code>고정 파라미터</code>가 부여되고,</p>\n<br />\n<p>이 <code>고정 파라미터</code>를 동일 플로우에 건네면 완전히 동일한 플로우가 실행됩니다.</p>\n<br />\n<p>고정 파라미터가 존재해야 <code>플로우</code>가 실패해도 재실행이 가능한 것이죠.</p>\n<br />\n<hr>\n<br />\n<ul>\n<li><strong>재시도</strong></li>\n</ul>\n<br />\n<p>여러 차례 반복하는 오류는 자동화하여 복구하고 싶을 겁니다.</p>\n<br />\n<p>하지만 재시도 횟수가 너무 적거나 혹은 너무 많은 경우 오히려 오류가 해결되지 않거나 중복되는 경우가 생깁니다.</p>\n<br />\n<p>즉, 재시도를 반복해도 문제가 없는 태스크라면 1회 혹은 2회 정도 재시도를 실행하는 것이 좋습니다.</p>\n<br />\n<ul>\n<li><strong>백필</strong></li>\n</ul>\n<br />\n<p>실패한 플로우를 복구하는 또 하나의 방법은 플로우 전체를 처음부터 다시 실행하는 것입니다. 이를 위해 <code>백필</code>의 기능을 이용할 수 있습니다.</p>\n<br />\n<p><code>백필</code>이란 파라미터에 포함된 일시를 순서대로 바꿔가며 일정 기간의 플로우를 연속해서 실행하는 구조입니다.</p>\n<br />\n<p>대규모의 백필을 실시하는 경우에는 자동적인 재시도는 무효로 하고, 오류는 모두 통지하는 편이 좋습니다. 그래야 부하를 떨어뜨릴 수 있기 때문입니다.</p>\n<br />\n<hr>\n<br />\n<h3 id=\"멱등한-조작\" style=\"position:relative;\"><a href=\"#%EB%A9%B1%EB%93%B1%ED%95%9C-%EC%A1%B0%EC%9E%91\" aria-label=\"멱등한 조작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>멱등한 조작</h3>\n<br />\n<p><code style='color:#f0506e'>원자성 조작</code> : 쓰기가 필요한 수만큼 태스크를 나누는 것을 의미합니다.</p>\n<br />\n<p>워크플로 안의 태스크를 모두 원자성 있는 조작으로 구현하여 재시도의 안정성을 높일 수 있습니다.</p>\n<br />\n<p>즉, 중간에 실패하고 재시도하여 발생할 수 있는 중복을 피할 수 있다는 겁니다.</p>\n<br />\n<p>단, 태스크 구현 상의 버그 등으로 문제가 발생하면 워크플로 관리 도구가 이를 오류로 여겨 중복 문제가 발생할 수 있습니다.</p>\n<br />\n<p><code style='color:#f0506e'>멱등한 조작</code> : 동일한 태스크를 여러 번 실행해도 동일한 결과가 되도록 하는 것을 의미합니다.</p>\n<br />\n<p>예를 들어 SQL이라면 ‘테이블을 삭제한 후 다시 만들기’와 같은 것을 의미합니다.</p>\n<br />\n<p>즉, 중복을 없애기 위함인데, 각 태스크를 어떻게 멱등하게 할 지는 이용자의 책임입니다.</p>\n<br />\n<p>일반적으로 <code>추가</code> 혹은 <code>치환</code>중 하나를 실시합니다.</p>\n<br />\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">DROP</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">IF</span> <span class=\"token keyword\">EXISTS</span> <span class=\"token string\">\"t1\"</span>\r\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token string\">\"t1\"</span>\r\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token string\">\"t1\"</span></code></pre></div>\n<br />\n<p>여러 번 실행해도 항상 치환이 시행되도록 설계해야 멱등한 태스크가 될 수 있습니다.</p>\n<br />\n<ul>\n<li><strong>멱등한 추가</strong></li>\n</ul>\n<br />\n<p>현실에서는 항상 멱등한 태스크를 구현할 수 없습니다.</p>\n<br />\n<p>즉, 그 날의 데이터만을 INSERT문으로 추가하고 싶은 경우에는 원자성을 갖고 실행할 순 있으나, 멱등하지는 않습니다.</p>\n<br />\n<p>과거의 모든 데이터를 치환해도 부하가 커지는 단점이 존재합니다.</p>\n<br />\n<p>이를 위해 <code style='color:#f0506e'>테이블 파티셔닝</code> 사고방식을 사용합니다.</p>\n<br />\n<p>예를 들면 1시간 마다 파티션을 분할하고, 파티션 단위로 치환하는 것입니다.</p>\n<br />\n<p>파티션의 모든 데이터를 삭제하기 위해 <code>TRUNCATE 문</code> 혹은 <code>INSERT OVERWRITE 문</code>을 사용하여 멱등성을 유지하며 보기에는 하나의 시계열 테이블에 데이터가 추가 되듯이 만들 수 있습니다.</p>\n<br />\n<p>이러한 테이블 파티셔닝의 구현은 시스템에 따라 달라지고 이에 맞추어 플로우를 조립합니다.</p>\n<br />\n<p><code>hive</code>의 경우 표준으로 파티셔닝에 대응하나, <code>Amazon Redshift</code>에서는 파티셔닝의 개념이 없어 <code>UNION ALL</code>을 사용한 뷰를 사용해야 합니다.</p>\n<br />\n<ul>\n<li><strong>원자성을 지닌 추가</strong></li>\n</ul>\n<br />\n<p>복잡한 플로우에서는 중간 테이블을 만들어 처리한 후, 마지막 목적 테이블에 한 번에 추가하는 것이 안전합니다.</p>\n<br />\n<p>중간 테이블은 매번 다시 작성하는 방식(멱등함)이고, 마지막에 목적 테이블에 한번에 작성하는 구조입니다.</p>\n<br />\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">// 중간 테이블 작성</span>\r\n<span class=\"token keyword\">DROP</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">IF</span> <span class=\"token keyword\">EXISTS</span> <span class=\"token string\">\"t1\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token string\">\"t1\"</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token string\">\"t1\"</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token string\">\"t1\"</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// 대상 테이블에 모아서 써넣음(추가)</span>\r\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> <span class=\"token string\">\"target_table\"</span>\r\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> <span class=\"token string\">\"t1\"</span></code></pre></div>\n<br />\n<br />\n<h3 id=\"워크플로-전체를-멱등으로-하기\" style=\"position:relative;\"><a href=\"#%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C-%EC%A0%84%EC%B2%B4%EB%A5%BC-%EB%A9%B1%EB%93%B1%EC%9C%BC%EB%A1%9C-%ED%95%98%EA%B8%B0\" aria-label=\"워크플로 전체를 멱등으로 하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>워크플로 전체를 멱등으로 하기</h3>\n<br />\n<p>재실행의 안전성을 높이기 위해 적어도 각 플로우가 전체로서 멱등하게 되도록 구현해야 합니다.</p>\n<br />\n<p>최종적으로 워크플로가 안정적으로 실행되는 것이 목적입니다.</p>\n<br />\n<hr>\n<br />\n<br />\n<h3 id=\"태스크-큐\" style=\"position:relative;\"><a href=\"#%ED%83%9C%EC%8A%A4%ED%81%AC-%ED%81%90\" aria-label=\"태스크 큐 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>태스크 큐</h3>\n<br />\n<p>워크플로 관리 도구에서 요구되는 다른 하나의 커다란 역할은 <strong>외부 시스템의 부하 컨트롤</strong>입니다. 자원의 소비량을 조정하여 모든 태스크가 원할하게 실행되야 하죠.</p>\n<br />\n<ul>\n<li><strong>병렬화</strong></li>\n</ul>\n<br />\n<p>이를 위해 우리는 병렬화를 먼저 생각할 수 있습니다.</p>\n<br />\n<p>만일 하나의 파일 전송을 하나의 태스크로 고려하고 8코어 서버를 이용할 수 있다고 해보면, 파일의 수만큼 태스크를 실행해야 합니다.</p>\n<br />\n<p>하지만 너무 대량의 태스크를 동시 실행하면 과부하가 걸리므로 이를 위해 사용하는 것이 <code>잡 큐(job queue)</code> 또는 <code>태스크 큐(task queue)</code>라고 불리는 구조입니다.</p>\n<br />\n<p>일단 모든 태스크가 이 큐에 저장되고 워커 프로세스가 이를 꺼내며 병렬화를 실행하는 것이죠.</p>\n<br />\n<p>그렇다면 워커의 수를 늘린다면 동시에 더 많은 태스크를 처리할 수 있을 겁니다.</p>\n<br />\n<p>하지만 우리는 이로 인해 발생하는 <code>병목 현상</code>을 무시할 수 없을 겁니다.</p>\n<br />\n<p>이로 인해 성능 향상의 한계점이나 오류가 발생합니다.</p>\n<br />\n<p>요인은 크게 <code>내부적인 요인</code>과 <code>외부적인 요인</code>으로 나뉩니다.</p>\n<br />\n<p><strong>내부적인 요인</strong></p>\n<ul>\n<li><code>CPU 사용률 100%</code> : CPU 코어 수를 늘림. 서버 증설</li>\n<li><code>메모리 부족</code>: 메모리 증설, 스왑 디스크 추가, 태스크 작게 분할</li>\n<li><code>디스크 넘침</code> : 각 태스크의 임시 파일 삭제, 디스크 증설</li>\n<li><code>디스크 I/O의 한계</code> : SSD 등의 고속 디스크 사용. 여러 디스크로 분산</li>\n<li><code>네트워크 대역의 한계</code> : 고속 네트워크 사용, 데이터 압축률 높임</li>\n<li><code>통신 오류나 타임 아웃</code> : 시스템 상의 한계, 서버 분리</li>\n</ul>\n<br />\n<p><strong>외부적인 요인</strong></p>\n<p>문제 제거가 직접적으로 어렵습니다.</p>\n<br />\n<p>예를 들면 파일 복사에서 오류가 날 때, 파일 서버 측의 성능 한계 등입니다.</p>\n<br />\n<p>즉, 워커를 오히려 줄일 필요가 있습니다.</p>\n<br />\n<p>분산 스토리지로 쓰는 빈도가 높아 오류가 발생하면 쓰기 빈도를 줄입니다.</p>\n<br />\n<br />\n<ul>\n<li><strong>태스크 수의 적정화</strong></li>\n</ul>\n<br />\n<p>사실은 하나의 파일 전송을 하나의 태스크로 고려한 것이 문제입니다.</p>\n<br />\n<p>예를 들어 태스크를 1일 단위로 나눈다면 1년 치 파일을 365개로 줄일 수 있습니다.</p>\n<br />\n<p>결과적으론 <span style='color:red; font-weight: bold;'>워크플로 관리 도구에 등록된 태스크는 모두 너무 크지도 않고, 너무 작지도 않은 적당한 크기로 분할된 다수의 태스크가 여러 워커로 부터 호출되는 상태</span>가 되야 합니다.</p>\n<br />\n<hr>\n<br />\n<br />\n<h3 id=\"배치-형의-데이터-플로우\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EC%B9%98-%ED%98%95%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%EC%9A%B0\" aria-label=\"배치 형의 데이터 플로우 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배치 형의 데이터 플로우</h3>\n<br />\n<ul>\n<li><strong>데이터 플로우</strong></li>\n</ul>\n<br />\n<p>기술의 발전에 따라 <strong>다단계의 데이터 처리를 분산 시스템 내에서 실행</strong>할 수 있게 된 것</p>\n<br />\n<p>배치 처리와 스트림 처리가 하나로 통합되어 통일된 프레임워크로부터 양쪽이 모두 실행되었습니다.</p>\n<br />\n<p><strong>데이터 플로우를 위한 프레임 워크</strong></p>\n<ul>\n<li>Google Cloud Dataflow</li>\n<li>Apache Spark</li>\n<li>Apache Flink</li>\n</ul>\n<br />\n<br />\n<h3 id=\"mapreduce의-구조\" style=\"position:relative;\"><a href=\"#mapreduce%EC%9D%98-%EA%B5%AC%EC%A1%B0\" aria-label=\"mapreduce의 구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MapReduce의 구조</h3>\n<br />\n<p>빅데이터의 대표적인 기술이었던 <code>MapReduce</code>였으나, 이제는 과거의 기술로 간주되어 구글의 차세대 기술인 <code>MillWheel</code>이라는 프레임워크에게 밀려버렸습니다.</p>\n<br />\n<p>하지만 MapReduce 자체 기술을 접할 기회가 많기에 그 구조를 알 필요가 있습니다.</p>\n<br />\n<ol>\n<li>파일을 일정 크기로 나누어 작은 데이터인 <code>split</code>으로 만듬</li>\n<li>나눈 데이터를 읽어 컴퓨터에 <code>분산 집계(Map)</code></li>\n<li>분산된 결과를 모아 <code>전부 집계(Reduce)</code></li>\n</ol>\n<br />\n<p>나눈 <code>split</code> 데이터를 분산 집계하는 과정을 <code style='color:#f0506e'>Map</code>이라고 하고, 분산 집계된 <code>split 데이터</code>를 한번에 모아 전부 집계하는 과정을 <code style='color:#f0506e'>Reduce</code>라고 합니다.</p>\n<br />\n<p>애드 혹 데이터 분석을 위해선 지연이 적어야 하지만 MapReduce는 지연이 발생하여 적합하지 않습니다.</p>\n<br />\n<p>하지만 <span style='color:red; font-weight: bold;'>Map과 Reduce를 반복한다.</span> 라는 사고 방식은 아직까지 유효합니다.</p>\n<br />\n<br />\n<h3 id=\"dag에-의한-내부-표현\" style=\"position:relative;\"><a href=\"#dag%EC%97%90-%EC%9D%98%ED%95%9C-%EB%82%B4%EB%B6%80-%ED%91%9C%ED%98%84\" aria-label=\"dag에 의한 내부 표현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DAG에 의한 내부 표현</h3>\n<br />\n<p><code style='color:#f0506e'>DAG(directed acyclic graph)</code>, 방향성 비순환 그래프라고 불리는 이 프레임워크는 MapReduce를 대신합니다.</p>\n<br />\n<p>DAG는 어떤 기술이 아니라 수학과 컴퓨터 알고리즘에 사용되는 데이터 모델의 하나 입니다.</p>\n<br />\n<ul>\n<li>노드와 노드가 화살표로 연결된다.(방향성)</li>\n<li>화살표를 아무리 따라가도 동일 노드로는 되돌아 오지 않는다.(비순환)</li>\n</ul>\n<br />\n<p>쉽게 말해 <span style='color:red; font-weight: bold;'>방향성을 지니고, 동일 노드로 돌아오지 않는(비순환) 그래프</span>라고 할 수 있습니다.</p>\n<br />\n<p>MapReduce도 Map과 Reduce라는 두 종류의 노드로 구성된 DAG라고 할 수 있습니다.</p>\n<br />\n<p>하지만 하나의 처리가 끝나기 전까지는 다음 처리를 진행할 수 없죠.</p>\n<br />\n<p>한편, 데이터 플로우에서 <span style='color:red; font-weight: bold;'>DAG를 구성하는 각 노드가 모두 동시 병행으로 실행됩니다.</span></p>\n<br />\n<p>즉, 대기 시간을 없앨 수 있다는 겁니다!</p>\n<br />\n<br />\n<h3 id=\"spark에-있어서의-dag\" style=\"position:relative;\"><a href=\"#spark%EC%97%90-%EC%9E%88%EC%96%B4%EC%84%9C%EC%9D%98-dag\" aria-label=\"spark에 있어서의 dag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark에 있어서의 DAG</h3>\n<br />\n<p>Spark와 같은 데이터 플로우 프레임워크에서는 프로그래밍 언어를 사용하여 직접 DAG의 데이터 구조를 조립합니다.</p>\n<br />\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 파일로부터 데이터를 읽음</span>\r\nlines <span class=\"token operator\">=</span> sc<span class=\"token punctuation\">.</span>textFile<span class=\"token punctuation\">(</span><span class=\"token string\">\"sample.txt\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 파일의 각 행을 단어로 분해</span>\r\nwords <span class=\"token operator\">=</span> lines<span class=\"token punctuation\">.</span>flatMap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 단어마다 카운터를 파일로 출력</span>\r\nwords<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> word<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \\\r\n    <span class=\"token punctuation\">.</span>reduceByKey<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span> \\\r\n    <span class=\"token punctuation\">.</span>saveAsTextFile<span class=\"token punctuation\">(</span><span class=\"token string\">\"word_counts\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<p>위 파이썬 스크립트는 Spark에서 데이터 처리를 하는 예입니다.</p>\n<br />\n<p>데이터 파이프라인 전체를 DAG로 조립하고, 실행으로 옮겨 내부 스케줄러가 시스템에 효과적인 실행 계획을 세워줍니다.</p>\n<br />\n<br />\n<h3 id=\"데이터-플로우와-워크플로의-조합\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%EC%9A%B0%EC%99%80-%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9D%98-%EC%A1%B0%ED%95%A9\" aria-label=\"데이터 플로우와 워크플로의 조합 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 플로우와 워크플로의 조합</h3>\n<br />\n<ul>\n<li><strong>데이터를 읽어들이는 플로우</strong></li>\n</ul>\n<br />\n<p>직접 데이터 소스에 액세스하면 성능 문제를 일으키기 쉽습니다.</p>\n<br />\n<p>따라서 <span style='color:red; font-weight: bold;'>분산 스토리지에 복사함으로써 안정적으로 사용</span>할 수 있도록 합니다.</p>\n<br />\n<ul>\n<li><strong>데이터를 써서 내보내는 플로우</strong></li>\n</ul>\n<br />\n<p>만일 데이터의 집계 결과를 외부 시스템에 써서 내보내는 경우에는 완전히 반대입니다.</p>\n<br />\n<p>데이터 플로우 안에서 대량의 데이터를 전송하는 것은 피하는 편이 좋습니다.</p>\n<br />\n<p>즉, <span style='color:red; font-weight: bold;'>데이터 플로우의 출력이 CSV파일과 같이 취급하기 쉬운 형식(스키마리스)으로 변환하여 일단 분산 스토리지에 써넣습니다.</span></p>\n<br />\n<p>그 후에 다음 태스크를 실행하는 겁니다.</p>\n<br />\n<p>예를 들어 데이터 마트를 <code>MPP 데이터베이스</code>로 이용한다면, <code>분산 스토리지</code>로 부터 파일을 로드하는 명령을 발행할 수 있습니다.</p>\n<br />\n<br />\n<h3 id=\"데이터-플로우와-sql을-나누어-사용하기\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%EC%9A%B0%EC%99%80-sql%EC%9D%84-%EB%82%98%EB%88%84%EC%96%B4-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"데이터 플로우와 sql을 나누어 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 플로우와 SQL을 나누어 사용하기</h3>\n<br />\n<ol>\n<li><strong>데이터 웨어하우스의 파이프라인</strong></li>\n</ol>\n<br />\n<p>SQL을 MPP 데이터베이스에서 실행하는 경우를 말합니다.</p>\n<br />\n<p>즉, 데이터 웨어하우스를 구축하는 경우 로드되는 데이터를 만드는 부분까지가 데이터 플로우의 역할입니다.</p>\n<br />\n<p>앞서 말했던 비구조화 데이터를 스키마리스 데이터로 가공하여 분산 스토리지에 써넣습니다. 태스크 실행과 SQL에 의한 쿼리 실행은 그 뒤에 맡깁니다.</p>\n<br />\n<ol start=\"2\">\n<li><strong>데이터 마트의 파이프라인</strong></li>\n</ol>\n<br />\n<p>쿼리 엔진을 이용해 데이터 마트를 구축하는 경우, 구조화 데이터를 만드는 부분까지가 데이터 플로우의 역할입니다.</p>\n<br />\n<p>분산 스토리지 상의 데이터를 배치로 가공하여 열 지향 스토리지 형식으로 보관한 후, 쿼리 엔진을 통한 SQL 실행이나 그 결과를 데이터 마트에 써서 내보냅니다.</p>\n<br />\n<hr>\n<br />\n<p>간단하게 정리하자면,</p>\n<br />\n<p>MPP 데이터베이스에서 SQL을 실시하는 경우, 즉 데이터 웨어하우스에서 후속적으로 배치 처리(SQL 집계)를 실시하는 경우, <code style='color:#f0506e'>데이터 플로우</code>는 <code>비 구조화 데이터</code>를 <code>스키마리스 데이터</code>로 만들어 <code>분산 스토리지에 저장</code>하는 과정까지이고,</p>\n<br />\n<p>쿼리 엔진을 사용하여 데이터 마트를 구축하는 경우에 <code style='color:#f0506e'>데이터 플로우</code>는 <code>비구조화 데이터</code>에서 <code>구조화 데이터(열 지향 스토리지)</code>로 만드는 부분까지입니다. 그 후, SQL 실행이나 그 결과를 데이터 마트에 쓰는 것입니다.</p>\n<br />\n<hr>\n<br />\n<br />\n<h3 id=\"대화식-플로우\" style=\"position:relative;\"><a href=\"#%EB%8C%80%ED%99%94%EC%8B%9D-%ED%94%8C%EB%A1%9C%EC%9A%B0\" aria-label=\"대화식 플로우 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대화식 플로우</h3>\n<br />\n<p>구조화 되지 않은 데이터를 애드 혹으로 분석할 때, 데이터 플로우를 사용하면 좋습니다.</p>\n<br />\n<p>스크립트 언어를 통해 데이터를 가공, 집계할 수 있습니다.</p>\n<br />\n<p>데이터 구조화가 된 이후에는 더욱 더 고속 집계가 가능하며 이는 쿼리 엔진을 통한 SQL 집계와 비교해도 손색이 없습니다.</p>\n<br />\n<p>시각화 도구와 쿼리 엔진을 직접 접속하는 경우 <code>ODBC</code>와 <code>JDBC</code> 드라이버가 사용됩니다.</p>\n<br />\n<p>하지만 안정적인 워크플로 운용을 위해서는 실적이 있는 RDB와 MPP 데이터베이스를 데이터 마트로 사용하는 것이 좋습니다.</p>\n<br />\n<br />\n<h3 id=\"스트리밍-형의-데이터-플로우\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%8A%B8%EB%A6%AC%EB%B0%8D-%ED%98%95%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%94%8C%EB%A1%9C%EC%9A%B0\" aria-label=\"스트리밍 형의 데이터 플로우 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스트리밍 형의 데이터 플로우</h3>\n<br />\n<p>이전에는 실시간 메시지 전달 방식으로 메시지 플로우를 중심으로 하는 데이터의 흐름을 다루었습니다.</p>\n<br />\n<p>그렇게 전달 받은 데이터를 분산 스토리지에 보관하는 부분부터 시작하는 것이 <code>배치 처리</code>라고 하고,</p>\n<br />\n<p>분산 스토리지를 거치지 않고 처리를 계속하는 것이 <code style='color:#f0506e'>스트림 처리</code>라고 합니다.</p>\n<br />\n<p>배치 처리와 스트림 처리는 서로 결점을 보완하는 관계입니다.</p>\n<br />\n<p>앞으로 도달할 데이터에만 흥미가 있다면 실시간 성이 높은 스트림 처리를 하고,</p>\n<br />\n<p>과거 데이터를 집계하고 싶다면 배치 처리를 하는 쪽이 우수합니다.</p>\n<br />\n<br />\n<h3 id=\"배치-처리와-스트림-처리-통합하기\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EC%B9%98-%EC%B2%98%EB%A6%AC%EC%99%80-%EC%8A%A4%ED%8A%B8%EB%A6%BC-%EC%B2%98%EB%A6%AC-%ED%86%B5%ED%95%A9%ED%95%98%EA%B8%B0\" aria-label=\"배치 처리와 스트림 처리 통합하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배치 처리와 스트림 처리 통합하기</h3>\n<br />\n<ul>\n<li>배치 처리의 경우</li>\n</ul>\n<br />\n<p>먼저 데이터가 있고 그 데이터가 작게 나뉘어 DAG 안에 흘러들어옵니다.</p>\n<br />\n<p>여기서 데이터 양이 정해지는 것을 <code>유한 데이터</code>라고 합니다.</p>\n<br />\n<ul>\n<li>스트림 처리의 경우</li>\n</ul>\n<br />\n<p>끊임없이 데이터가 생성되며 그것이 DAG안에 흘러들어옵니다.</p>\n<br />\n<p>제한이 없이 데이터가 보내지는 것을 <code>무한 데이터</code>라고 합니다.</p>\n<br />\n<hr>\n<br />\n<br />\n<h3 id=\"spark-스트리밍의-dag\" style=\"position:relative;\"><a href=\"#spark-%EC%8A%A4%ED%8A%B8%EB%A6%AC%EB%B0%8D%EC%9D%98-dag\" aria-label=\"spark 스트리밍의 dag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark 스트리밍의 DAG</h3>\n<br />\n<p>Spark는 본래 배치 처리를 위한 분산 시스템이었으나, <code>Spark 스트리밍</code>이라 불리는 기능이 통합되어 스트림 처리까지 투명하게 취급하게 되었습니다.</p>\n<br />\n<p><span style='background-color:#fff5b1'>단어를 세는 Spark 스트리밍 프로그램</span></p>\n<br />\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 1초마다 스트림 처리를 합니다.</span>\r\nsc <span class=\"token operator\">=</span> SparkContext<span class=\"token punctuation\">(</span><span class=\"token string\">\"local[2]\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NetworkWordCount\"</span><span class=\"token punctuation\">)</span>\r\nssc <span class=\"token operator\">=</span> StreamingContext<span class=\"token punctuation\">(</span>sc<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># TCP 포트 9999로부터 데이터를 읽어 들입니다.</span>\r\nlines <span class=\"token operator\">=</span> ssc<span class=\"token punctuation\">.</span>socketTextStream<span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9999</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 입력의 각 행을 단어로 분해합니다.</span>\r\nwords <span class=\"token operator\">=</span> lines<span class=\"token punctuation\">.</span>flatmap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 단어별 갯수를 콘솔에 출력합니다.</span>\r\nwords<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> word<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \\\r\n    <span class=\"token punctuation\">.</span>reduceByKey<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span> \\\r\n    <span class=\"token punctuation\">.</span>pprint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 스트림 처리를 시작합니다.</span>\r\nssc<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<p>데이터 처리가 끝나면 종료되는 배치 처리와는 달리 스트림 처리는 프로그램을 정지할때 까지 끊임 없이 실행됩니다.</p>\n<br />\n<hr>\n<br />\n<br />\n<h3 id=\"스트림-처리의-결과를-배치-처리로-치환하기\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%8A%B8%EB%A6%BC-%EC%B2%98%EB%A6%AC%EC%9D%98-%EA%B2%B0%EA%B3%BC%EB%A5%BC-%EB%B0%B0%EC%B9%98-%EC%B2%98%EB%A6%AC%EB%A1%9C-%EC%B9%98%ED%99%98%ED%95%98%EA%B8%B0\" aria-label=\"스트림 처리의 결과를 배치 처리로 치환하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스트림 처리의 결과를 배치 처리로 치환하기</h3>\n<br />\n<p>스트림 처리의 경우 원칙적으로 새롭게 도달한 데이터를 처리할 뿐이므로 과거의 데이터를 처리하거나, 지연에 의해 늦게 도착한 데이터를 이벤트 시간으로 집계하여 생기는 문제를 해결하기 어렵습니다.</p>\n<br />\n<p>이를 위해 배치 처리를 별개로 실행하여 이 결과를 옳다고 하는 것이 전통적인 방법입니다.</p>\n<br />\n<br />\n<h3 id=\"람다-아키텍처\" style=\"position:relative;\"><a href=\"#%EB%9E%8C%EB%8B%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\" aria-label=\"람다 아키텍처 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>람다 아키텍처</h3>\n<br />\n<p>람다 아키텍처는 이 전통적인 방법을 발전시킨 것입니다.</p>\n<br />\n<p>크게 배치 레이어, 서빙 레이어, 스피드 레이어에서 데이터를 처리합니다.</p>\n<br />\n<p><code>배치 레이어</code>에서는 대규모 배치 처리를 실시합니다. 그 후, <code>서빙 레이어</code>를 통해 접근하여 집계 결과를 추출할 수 있습니다.</p>\n<br />\n<p>여기서 얻어진 결과를 <code>배치 뷰</code>라고 하는데, 이 <code>배치 뷰</code>는 정기적으로 업데이트 되는 대신 실시간 정보를 얻을 수는 없습니다.</p>\n<br />\n<p>그래서 다른 경로로 스트림 처리를 하기 위해 <code>스피드 레이어</code>를 설치합니다.</p>\n<br />\n<p>여기서 얻은 결과를 <code>실시간 뷰</code>라고 합니다.</p>\n<br />\n<p>마지막으로 배치 뷰와 실시간 뷰를 모두 조합하는 형태로 쿼리를 실행합니다.</p>\n<br />\n<p><span style='color:red; font-weight: bold;'>최근의 집계 결과는 실시간 뷰를 참고하고 그 이전의 데이터는 배치 뷰를 사용하며 이후, 실시간 뷰의 결과는 배치 뷰로 치환됩니다.</span></p>\n<br />\n<br />\n<h3 id=\"카파-아키텍처\" style=\"position:relative;\"><a href=\"#%EC%B9%B4%ED%8C%8C-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\" aria-label=\"카파 아키텍처 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>카파 아키텍처</h3>\n<br />\n<p>람다 아키텍처의 나쁜 개발 효율이라는 문제점으로 인해 람다 아키텍처를 단순화한 카파 아키텍처를 선택할 수 있습니다.</p>\n<br />\n<p>이는 람다 아키텍처의 배치 레이어나 서빙 레이어를 완전히 제거하고, 스피드 레이어만 남겨놓습니다.</p>\n<br />\n<p>대신 메시지 브로커의 데이터 보관 기간으르 충분히 하여 문제가 발생한 경우 여기서 데이터를 다시 멱등하게 치환하도록 보냅니다.</p>\n<br />\n<p>하지만 부하가 높아지기에 계산 자원을 많이 소요하나 클라우드의 보급으로 어느정도 해결하게 되었습니다.</p>\n<br />\n<br />\n<h3 id=\"아웃-오브-오더의-데이터-처리\" style=\"position:relative;\"><a href=\"#%EC%95%84%EC%9B%83-%EC%98%A4%EB%B8%8C-%EC%98%A4%EB%8D%94%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B2%98%EB%A6%AC\" aria-label=\"아웃 오브 오더의 데이터 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아웃 오브 오더의 데이터 처리</h3>\n<br />\n<p>프로세스 시간과 이벤트 시간의 차이를 기술적으로 <code style='color:#f0506e'>아웃 오브 오더</code>의 데이터 문제라고 합니다.</p>\n<br />\n<p>하지만 결국 프로세스 시간 보다는 이벤트 시간을 집계해야 올바른 결과를 얻을 수 있기에 이를 위한 방법을 도입합니다.</p>\n<br />\n<p>스트림 처리에서 시간을 일정 간격으로 나누어 <code>윈도우</code>를 만들고 이 안에서 집계합니다.</p>\n<br />\n<p>이벤트 시간에 의해 윈도우를 나누는 것을 <code>이벤트 시간 윙도윙</code>이라고 합니다.</p>\n<br />\n<p>다만, 과거의 이벤트 데이터를 보관할 때, 무한히 보관할 수는 없으므로 일정 이상 늦게 온 데이터는 무시할 필요도 있습니다.</p>\n<br />\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABcklEQVQ4y22UyZLDIAxE+f/v9MFLjDe8L0w9jdtFOTkoyNBSSy2IW9c1LssSt22L+76bP8+zrXzjhxAiOL67rott28amaR4MdhyHmVuW/2BsHMfY970FKImv65hlWRxCMAyJZOHeo5jzPC2x40fViQWQ/NQI4myaJqucvWEYrAByWIXvIALSFtl7r6k13seyLI0Awq+EqWbvM+mVdkWFmMjcmxkgCdXCr6Qi1QBFbho2TWsM/c1UFIVZVVUGZKp1XZtuJMDnjDZJin4YZ9aygDBhTDltg8l/Ph9b+SYJGIiIE1aD/Gr5PXVYqRQy6YdPISn+uYe/rgaWEqgLmYan+5fiHXrkeW7a6KWk5r03zWiRBNILCSCSzjp3JEIjCY8eYQhxuvUEyB4rSSDA56XwevApiEFC5MiqW39d19OCjPP05WhfWFb9H9i1EUjv2CoMwaqVdlRDqxoGWE2XGL0S01DT1HUQUMZ+XuSmI/77nJh04n/mZ49WTOHanAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"워크플로\"\n        title=\"워크플로\"\n        src=\"/static/24c469870a9aee30ef3e6d88e6918864/37523/%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C.png\"\n        srcset=\"/static/24c469870a9aee30ef3e6d88e6918864/e9ff0/%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C.png 180w,\n/static/24c469870a9aee30ef3e6d88e6918864/f21e7/%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C.png 360w,\n/static/24c469870a9aee30ef3e6d88e6918864/37523/%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C.png 720w,\n/static/24c469870a9aee30ef3e6d88e6918864/121b3/%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C.png 1070w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>","frontmatter":{"date":"February 25, 2023","title":"빅 데이터를 지탱하는 기술 책 리뷰 - (4)","categories":"Engineer","author":"DEVEL","emoji":"🐰"},"fields":{"slug":"/data-engineer-5/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://hsjni0110.github.io/devel-repo","comments":{"utterances":{"repo":"hsjni0110/hsjni0110.github.io"}}}}},"pageContext":{"slug":"/algorithm-1/","nextSlug":"/data-engineer-5/","prevSlug":""}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}